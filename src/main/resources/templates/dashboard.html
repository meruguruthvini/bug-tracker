<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-light">

<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-4">

    <h2 class="mb-4 fw-bold">ðŸ“Š Dashboard</h2>

    <div class="row g-4">

        <!-- Total Bugs -->
        <div class="col-md-3">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-body text-center">
                    <i class="fa-solid fa-bug fa-3x text-primary mb-3"></i>
                    <h4 class="fw-bold">Total Bugs</h4>
                    <h2 class="fw-bold text-primary" th:text="${totalBugs}"></h2>
                </div>
            </div>
        </div>

        <!-- Open Bugs -->
        <div class="col-md-3">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-body text-center">
                    <i class="fa-solid fa-folder-open fa-3x text-info mb-3"></i>
                    <h4 class="fw-bold">Open Bugs</h4>
                    <h2 class="fw-bold text-info" th:text="${openBugs}"></h2>
                </div>
            </div>
        </div>

        <!-- In Progress -->
        <div class="col-md-3">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-body text-center">
                    <i class="fa-solid fa-spinner fa-3x text-warning mb-3"></i>
                    <h4 class="fw-bold">In Progress</h4>
                    <h2 class="fw-bold text-warning" th:text="${inProgressBugs}"></h2>
                </div>
            </div>
        </div>

        <!-- Closed Bugs -->
        <div class="col-md-3">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-body text-center">
                    <i class="fa-solid fa-circle-check fa-3x text-success mb-3"></i>
                    <h4 class="fw-bold">Closed Bugs</h4>
                    <h2 class="fw-bold text-success" th:text="${closedBugs}"></h2>
                </div>
            </div>
        </div>

    </div>

    <!-- Charts Section -->
    <div class="row mt-5 g-4">

        <!-- Status Pie Chart -->
        <div class="col-md-6">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-body">
                    <h5 class="fw-bold mb-3">Bug Status Distribution</h5>
                    <canvas id="statusChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Priority Bar Chart -->
        <div class="col-md-6">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-body">
                    <h5 class="fw-bold mb-3">Priority Breakdown</h5>
                    <canvas id="priorityChart"></canvas>
                </div>
            </div>
        </div>

    </div>

</div>

<!-- Chart JS Script -->
<script>
    const statusChart = new Chart(document.getElementById("statusChart"), {
        type: "pie",
        data: {
            labels: ["Open", "In Progress", "Closed"],
            datasets: [{
                data: [
                    [[${openBugs}]],
                    [[${inProgressBugs}]],
                    [[${closedBugs}]]
                ],
                backgroundColor: ["#0dcaf0", "#ffc107", "#198754"]
            }]
        }
    });

    const priorityChart = new Chart(document.getElementById("priorityChart"), {
        type: "bar",
        data: {
            labels: ["LOW", "MEDIUM", "HIGH"],
            datasets: [{
                label: "Bug Count",
                data: [
                    [[${lowPriority}]],
                    [[${mediumPriority}]],
                    [[${highPriority}]]
                ],
                backgroundColor: ["#0d6efd", "#6f42c1", "#dc3545"]
            }]
        }
    });
</script>

</body>
</html>
