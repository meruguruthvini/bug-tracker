<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" th:href="@{/style.css}">

    <title>Bug Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

<!-- Navbar -->
<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-4">

    <h2 class="fw-bold">Bug Details</h2>
    <hr>

    <!-- Bug Information -->
    <p><strong>ID:</strong> <span th:text="${bug.id}"></span></p>
    <p><strong>Title:</strong> <span th:text="${bug.title}"></span></p>
    <p><strong>Description:</strong> <span th:text="${bug.description}"></span></p>
    <p><strong>Priority:</strong> <span th:text="${bug.priority}"></span></p>
    <p><strong>Status:</strong> <span th:text="${bug.status}"></span></p>
    <p><strong>Assigned To:</strong> <span th:text="${bug.assignedTo}"></span></p>

    <hr>

    <!-- COMMENT SECTION -->
    <h3 class="fw-bold">Comments</h3>

    <div th:if="${#lists.isEmpty(comments)}">
        <p class="text-muted">No comments yet.</p>
    </div>

    <div th:each="comment : ${comments}" class="card mb-3">
        <div class="card-body">
            <p th:text="${comment.message}"></p>
            <small class="text-muted">
                By <span th:text="${comment.userEmail}"></span> |
                <span th:text="${comment.createdAt}"></span>
            </small>
        </div>
    </div>

    <!-- Add New Comment -->
    <form th:action="@{'/bugs/' + ${bug.id} + '/comments'}" method="post" class="mt-3">
        <textarea name="message" class="form-control" rows="3"
                  placeholder="Add a comment..." required></textarea>
        <button class="btn btn-primary mt-2">Post Comment</button>
    </form>

    <hr class="mt-5">

    <!-- ACTIVITY LOGS SECTION -->
    <h3 class="fw-bold">Activity Log</h3>

    <div th:if="${#lists.isEmpty(logs)}">
        <p class="text-muted">No activity yet.</p>
    </div>

    <div class="list-group" th:each="log : ${logs}">
        <div class="list-group-item">
            <b th:text="${log.action}"></b><br>
            <small class="text-muted">
                By <span th:text="${log.performedBy}"></span> |
                <span th:text="${log.timestamp}"></span>
            </small>
        </div>
    </div>

</div>

</body>
</html>
